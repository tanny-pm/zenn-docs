---
title: "Beautiful Soupで店舗情報を取得してGoogleマップに表示する"
emoji: "🐠"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [python, beautifulsoup]
published: false
---

# 店舗情報を取得する

## ライブラリのインポート

```py
import csv

import requests
from bs4 import BeautifulSoup
```

## データの取得

```py
PAGE_URL = "https://www.adana.co.jp/jp/contents/retailer/shop.html"
r = requests.get(PAGE_URL)
r.encoding = r.apparent_encoding # エンコーディングをUTF-8に設定

soup = BeautifulSoup(r.text)
soup.title
```

```html
<title>販売特約店をさがす | ADA - SHOP</title>
```

```py
# １番目の店舗情報を取得
soup.find("a", class_=["basic-tr", "basic-tr-link"])
```

```html
<a
  class="basic-tr-link"
  href="https://www.sample.com/"
  rel="noopener"
  target="_blank"
>
  <div class="basic-td">
    <p>
      <span class="shopname"
        >店舗名<i class="fas fa-external-link-alt"></i></span
      ><br />
      住所<br />
      <i class="fas fa-phone"></i>111-2222-3333<br />
      営業時間：10:00-19:00<br />定休日：年中無休
    </p>
  </div>
  <!-- 省略 -->
</a>
```

## データの整形

```py
shop_list = []

for row in soup.find_all("a", class_=["basic-tr", "basic-tr-link"]):
    shop_info = {}
    shop_detail = row.div.p.get_text(',', strip=True).split(',')

    shop_info["name"] = shop_detail[0]
    shop_info["url"] = row.get("href")
    shop_info["address"] = shop_detail[1]
    shop_info["phone"] = shop_detail[2]
    shop_info["open"] = " ".join(shop_detail[3:])

    shop_list.append(shop_info)

shop_list[0]
```

```py
{'name': '店舗名',
 'url': 'https://www.sample.com/',
 'address': '住所',
 'phone': '111-2222-3333',
 'open': '営業時間：10:00-19:00 定休日：年中無休'}
```

## CSV出力

```py
with open("shop_list.csv", "w") as f:
    writer = csv.DictWriter(f, fieldnames = shop_list[0].keys())
    writer.writeheader()
    writer.writerows(shop_list)
```

# Googleマップに表示する

# おわりに
