---
title: "Raspberry Pi OSã®Pythonä»®æƒ³ç’°å¢ƒå†…ã§gpiozeroã‚’ä½¿ã†ã«ã¯"
emoji: "ğŸ”—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [raspberrypi, python, gpiozero]
published: true
---

# çµè«–

Raspberry Pi OSã®Pythonä»®æƒ³ç’°å¢ƒå†…ã§gpiozeroã‚’ä½¿ã†å ´åˆã€`venv`ã®`--system-site-packages`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã¨ã†ã¾ãã„ãã¾ã™ã€‚

```sh
$ mkdir testenv        
$ cd testenv 
$ python -m venv .env --system-site-packages
$ source .env/bin/activate
ï¼ˆä»¥é™ã€ä»®æƒ³ç’°å¢ƒå†…ã§gpiozeroã‚’ä½¿ãˆã‚‹ï¼‰
```

â€» æ­£ç¢ºã«ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®Pythonã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã™ã¹ã¦ä½¿ãˆã‚‹çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸç’°å¢ƒã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
- Raspberry Pi 5
- Raspberry Pi OS (64 bit) 12.5 bookworm
- Python 3.11.2

# èƒŒæ™¯ã¨èª²é¡Œ

æœ€æ–°ã®Raspberry Pi OS (Bookworm)ã§ã¯ã€`pip install`ã§ã‚·ã‚¹ãƒ†ãƒ ãƒ¯ã‚¤ãƒ‰ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªããªã£ã¦ã„ã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚

```sh
$ pip install buildhat
error: externally-managed-environment

Ã— This environment is externally managed
â•°â”€> To install Python packages system-wide, try apt install
  python3-xyz, where xyz is the package you are trying to
  install.

  If you wish to install a non-Debian-packaged Python package,
  create a virtual environment using python3 -m venv path/to/venv.
  Then use path/to/venv/bin/python and path/to/venv/bin/pip. Make
  sure you have python3-full installed.

  For more information visit http://rptl.io/venv

note: If you believe this is a mistake, please contact your Python installation or OS distribution provider. You can override this, at the risk of breaking your Python installation or OS, by passing --break-system-packages.
hint: See PEP 668 for the detailed specification.
```

ã¨ã„ã†ã‚ã‘ã§ã€pipã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„å ´åˆã€ä»®æƒ³ç’°å¢ƒã‚’ä½¿ã†ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

â€» ã“ã®è¾ºã‚Šã®è©³ç´°ãªè©±ã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
https://www.raspberrypi.com/documentation/computers/os.html#about-python-virtual-environments

---

ã—ã‹ã—ãªãŒã‚‰ã€GPIOåˆ¶å¾¡ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®gpiozeroã‚’ä»®æƒ³ç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä½¿ãŠã†ã¨ã™ã‚‹ã¨ã€ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

```sh
$ mkdir testenv
$ cd testenv 
$ python -m venv .env
$ source .env/bin/activate
.env $ pip install gpiozero
.env $ python
Python 3.11.2 (main, Mar 13 2023, 12:18:29) [GCC 12.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from gpiozero import LED
>>> led = LED(17)
ï¼ˆç•¥ï¼‰
gpiozero.exc.BadPinFactory: Unable to load any default pin factory!
```

ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å€‹åˆ¥ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ãŒã€ã‚¨ãƒ©ãƒ¼æ–‡è¨€ã‹ã‚‰ã¯å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒæŠŠæ¡ã§ããšã€ãŠæ‰‹ä¸Šã’ã§ã—ãŸğŸ˜‡

# è§£æ±ºç­–

ã‚¨ãƒ©ãƒ¼æ–‡è¨€ã§ã‚°ã‚°ã£ã¦ã¿ãŸã‚‰ã€åŒã˜ã‚ˆã†ãªå•é¡Œã«è¨€åŠã—ã¦ã„ã‚‹issuesãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚ã€Œåˆå¿ƒè€…ãŒæ··ä¹±ã—ãªã„ï¼Ÿã€ã¨ã„ã†è³ªå•ã«å¯¾ã—ã¦ã€ã€Œã™ã§ã«å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«è¨€åŠã•ã‚Œã¦ã„ã‚‹ã‚ˆã€ã¨ã®ã“ã¨ã§ã—ãŸã€‚

https://github.com/raspberrypi/documentation/issues/3220

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹ãŸã¨ã“ã‚ã€`--system-site-packages`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã¦`venv`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ã®Pythonã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚

> NOTE
> If you want to inherit the currently installed packages from the system Python, you should create your virtual environment using python -m venv --system-site-packages env.

å†’é ­ã«ç´¹ä»‹ã—ãŸã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»®æƒ³ç’°å¢ƒå†…ã§gpiozeroã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

è¿½åŠ ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„å ´åˆã€ä»®æƒ³ç’°å¢ƒå†…ã§`pip install`ã‚’å®Ÿè¡Œã™ã‚Œã°OKã§ã™ã€‚

